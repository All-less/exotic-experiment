<html>
<body>
    <h1>Welcome, {{username}}</h1>
    <button onclick='server.user.acquire()'>acquire</button>
    <button onclick='server.user.release()'>release</button>
    <form action='./file' enctype="multipart/form-data" method='post' target= "hframe">
        <input type='file' name='file' id='file' />
        <input type='submit' name='submit' value='Upload'/>
		{% raw xsrf_form_html() %}
        <iframe name ="hframe" id="hframe" style=" display: none" ></iframe >
    </form>
    <a href='./file/download'>Download uploaded file</a>
    <script src='/static/server.js'></script>
    <script>
        window.addEventListener('keydown', function(event){
            server.keyDown(event.keyCode);
        })
        window.addEventListener('keyup', function(evnet){
            server.keyUp(event.keyCode);
        })
        function newMessage(msg){
            var div  = document.createElement('div');
            div.innerHTML = msg;
            document.body.appendChild(div);
        }
        server.remote.setKeyDown(function(code){
            newMessage('Key Down ' + code);
        });
        server.remote.setKeyUp(function(code){
            newMessage('Key Up ' + code);
        });
        server.remote.setSwitchPress(function(id){
            newMessage('Switch Press ' + id);
        });
        server.remote.setUserChange(function(user){
            newMessage('user Change to ' + user);
            console.log(user);
        });
        server.remote.setLeave(function(){
            newMessage('RPI leave');
        });
        server.remote.setFileUpload(function(info){
            newMessage('file received with size: ' + info.size);
        });
        server.remote.setFileProgram(function(){
            newMessage('file program.');
        });
    </script>
</body>
</html>
